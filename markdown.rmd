---
title: "Trabalho Pratico 3 Metodos econometricos"
author: "Grupo 9"
date: "31 de outubro de 2022"
output:
  html_document: default
  pdf_document:
    keep_tex: yes
  word_document: default
editor_options:
  markdown:
    wrap: 72

---

** Relatorio Grupo 9 **

Tema: *relat√≥rio completo sobre investimento em empresas estatais*

## Quest√£o 0 - Iniciando arquivos e dados

```{r}
library(AER)
library(strucchange)
library(fBasics)
library(quantreg)
library(quantmod)

data <- read.table('ArquivoExercicio3.csv',sep=';',dec='.',header = T)
```
## Quest√£o 1
A partir dos dados brutos, construa os seguintes indicadores e inclua-os no dataframe original.
Em seguida, gere o resumo estat√≠stico da base de dados Dica: se usar o comando base$X<-y, √© criada
uma nova coluna na tabela com nome de X contendo a vari√°vel y.
a) Book-to-Market= ùëÉùêø/ùëâùëéùëôùëúùëüùëÄùëíùëüùëêùëéùëëùëú com nome de BtM
b) Rela√ß√£o PL e Passivo = ùëÉùêø/ùëÉùëéùë†ùë†ùëñùë£ùëú com nome de RPLP
c) ROA = ùêøùêø / ùê¥ùë°ùëñùë£ùëúùëáùëúùë°ùëéùëô com nome de ROA
d) ROE= ùêøùêø /ùëÉùêø com nome de ROE
```{r}
data$BtM <- data$PL / data$ValorMercado
data$RPLP <- data$PL / data$Passivo
data$ROA <- data$LL / data$AtivoTotal
data$ROE <- data$LL / data$PL
summary(data)
```
## Quest√£o 2
Estime o modelo de regress√£o m√∫ltipla a seguir e analise os coeficientes, R^2, R^2 ajustado e o Teste F:
Divùëñ = ùõº + ùõΩ1BtMùëñ + ùõΩ2RPLPùëñ + ùõΩ3ROAùëñ + ùõΩ4ROEùëñ + ùõΩ5AtivoTotal
```{r}
reg <- lm(Div ~ BtM + RPLP + ROA + ROE + AtivoTotal, data = data)
summary(reg)
```
## Quest√£o 3
Calcule e analise o Fator da Infla√ß√£o da Vari√¢ncia e a matriz de covari√¢ncia dos coeficientes
do modelo estimado. Analise os resultados e conclua sobre a adequabilidade da modelagem.
```{r}
vif(reg)
vcov(reg)
```
## Quest√£o 4
Reestime o modelo retirando o ROA e analise o Fator da Infla√ß√£o da Vari√¢ncia e a matriz de
covari√¢ncia dos coeficientes do modelo estimado. Ademais, realize o teste ANOVA para comparar
os dois modelos, sendo este modelo sem a vari√°vel ROA o modelo restrito.
```{r}
reg2 <- lm(Div ~ BtM + RPLP + ROE + AtivoTotal, data = data)

vif(reg2)
vcov(reg2)
anova(reg,reg2)
```
## Quest√£o 5
Analise os coeficientes, o R^2 Ajustado e a estat√≠stica F do modelo.
```{r}
summary(reg2)
```
## Quest√£o 6
Crie o gr√°fico de dispers√£o, histograma e o gr√°fico quantil-quantil dos res√≠duos da regress√£o.
Analise os gr√°ficos gerados.
```{r}
par(mfrow=c(2, 2))
plot(reg2$residuals)
hist(reg2$residuals)
qqPlot(reg2$residuals)
```
## Quest√£o 7
Realize e analise os seguintes testes de normalidade nos res√≠duos da regress√£o, citando a H0 e
H1 de cada um:
a) Teste de Shapiro
b) Teste Jarque-Bera
c) Teste de Breusch-Pagan
d) Teste de Durbin-Watson
```{r}
shapiro.test(reg2$residuals)
jarque.bera.test(reg2$residuals)
bptest(reg2)
dwtest(reg2)
```
## Quest√£o 8
Realize os testes de heterocedasticidade (White e Breusch-Pagan) para verificar a
heterocedasticidade nos res√≠duos do modelo e analise o resultado dos mesmos.7
```{r}
paste("----- TESTE BP -----")
bptest(reg2)
reg3 <- lm(Div ~
             BtM * RPLP +
               BtM * ROE +
               BtM * AtivoTotal +
               RPLP * ROE +
               ROE * AtivoTotal
               + I(AtivoTotal^2) + I(BtM^2)
               + I(RPLP^2) + I(ROE^2), data = data)
paste("----- TESTE WHITE -----")
bptest(reg3)
```
## Quest√£o 9
Realize o teste RESET para verificar problemas de forma funcional no modelo e analise o
resultado do teste. Conclua sobre a valida√ß√£o do modelo estimado.
```{r}
reset(reg2)
```
## Quest√£o 10
Estime a matriz de covari√¢ncia com erros padr√£o de White e o valor dos coeficientes corrigidos.
Dica: procure sobre a fun√ß√£o ‚Äúcoeftest‚Äù.
```{r}
vcovHC(reg2)
vcov(reg2)
```
## Quest√£o 11
Estime o modelo de regress√£o m√∫ltipla a seguir e analise os coeficientes, R2, R2 ajustado e o Teste F:
log(Divùëñ) = ùõº + ùõΩ1BtMùëñ + ùõΩ2RPLPùëñ + ùõΩ3ROEùëñ + ùõΩ4log(AtivoTotalùëñ )
```{r}
reg4 <- lm(log(Div) ~ BtM + RPLP + ROE + log(AtivoTotal), data = data)
summary(reg4)
```
## Quest√£o 12
Refa√ßa os testes propostos nas quest√µes 7,8 e 9. Conclua sobre a validade da modelagem e os
efeitos da reespecifica√ß√£o do modelo.
```{r}
paste("--- Teste de Shapiro ---")
shapiro.test(reg4$residuals)
paste("--- Teste Jarque-Bera ---")
jarque.bera.test(reg4$residuals)
paste("--- Teste de Breusch-Pagan ---")
bptest(reg4)
paste("--- Teste de Durbin-Watson ---")
dwtest(reg4)
reg4White <- lm(log(Div) ~
             BtM * RPLP +
               BtM * ROE +
               BtM * log(AtivoTotal) +
               RPLP * ROE +
               ROE * log(AtivoTotal)
               + I(log(AtivoTotal)^2) + I(BtM^2)
               + I(RPLP^2) + I(ROE^2), data = data)
paste("--- Teste de White ---")
bptest(reg4White)
paste('--- Teste Reset ---')
reset(reg4)
```